<!DOCTYPE html>

<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 4 & Angular 7
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
Renew Support: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<!-- begin::Head -->
<head>
    <meta charset="utf-8"/>
    <title>Login | GRisk</title>
    <meta name="description" content="GRisk Login">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--begin::Fonts -->
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
    <script>
        WebFont.load({
            google: {
                "families": ["Poppins:300,400,500,600,700", "Roboto:300,400,500,600,700"]
            },
            active: function () {
                sessionStorage.fonts = true;
            }
        });
    </script>

    <!--end::Fonts -->

    <!--begin::Page Custom Styles(used by this page) -->
    <link th:href="@{/login/css/login-4.css}" rel="stylesheet" type="text/css"/>

    <!--end::Page Custom Styles -->

    <!--begin:: Global Mandatory Vendors -->
    <link th:href="@{/vendors/general/perfect-scrollbar/css/perfect-scrollbar.css}" rel="stylesheet" type="text/css"/>

    <!--end:: Global Mandatory Vendors -->

    <!--begin:: Global Optional Vendors -->
    <link th:href="@{/vendors/general/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.css}" rel="stylesheet"
          type="text/css"/>
    <link th:href="@{/vendors/general/animate.css/animate.css}" rel="stylesheet" type="text/css"/>

    <!--end:: Global Optional Vendors -->

    <!--begin::Global Theme Styles(used by all pages) -->
    <link th:href="@{/login/css/style.bundle.css}" rel="stylesheet" type="text/css"/>

    <!--end::Layout Skins -->
    <link rel="shortcut icon" th:href="@{/favicon.ico}">
</head>

<!-- end::Head -->

<!-- begin::Body -->
<body class="kt-quick-panel--right kt-demo-panel--right kt-offcanvas-panel--right kt-header--fixed kt-header-mobile--fixed kt-subheader--fixed kt-subheader--enabled kt-subheader--solid kt-aside--enabled kt-aside--fixed kt-page--loading">

<!-- begin:: Page -->
<div class="kt-grid kt-grid--ver kt-grid--root">
    <div class="kt-grid kt-grid--hor kt-grid--root  kt-login kt-login--v4 kt-login--signin" id="kt_login">
        <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor"
             th:style="'background:url(' + @{/images/bg-2.jpg} + '); background-color: #261a3c;'">
            <div class="kt-grid__item kt-grid__item--fluid kt-login__wrapper">
                <div th:if="${proccess == null}" class="kt-login__container">
                    <div class="kt-login__logo">
                        <a th:href="@{/login}">
                            <img alt="" th:src="@{/images/grisk-reverse.png}">
                        </a>
                    </div>
                    <div class="kt-login__signin">
                        <div class="kt-login__head">
                            <h3 class="kt-login__title">Bienvenido</h3>
                        </div>
                        <form id="login_signin" class="kt-form" th:action="@{/check_login}" method="POST">
                            <div class="input-group">
                                <input class="form-control" type="text" placeholder="Usuario o correo electrónico"
                                       name="username"
                                       autocomplete="off">
                            </div>
                            <div class="input-group">
                                <input class="form-control" type="password" placeholder="Contraseña" name="password">
                            </div>
                            <div class="row kt-login__extra">
                                <div class="col">
                                    <label class="kt-checkbox">
                                        <input type="checkbox" name="remember-me"> Recuérdame
                                        <span></span>
                                    </label>
                                </div>
                                <div class="col kt-align-right">
                                    <a href="javascript:;" id="kt_login_forgot" class="kt-login__link">¿Has olvidado tu
                                        contraseña?</a>
                                </div>
                            </div>
                            <div class="kt-login__actions">
                                <button id="kt_login_signin_submit"
                                        class="btn btn-brand btn-pill kt-login__btn-primary">Ingresar
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="kt-login__signup">
                        <div class="kt-login__head">
                            <h3 class="kt-login__title">Regístrate</h3>
                            <div class="kt-login__desc">Por favor ingrese los siguientes detalles:
                            </div>
                        </div>
                        <div class="kt-login__head">
                            <form class="kt-form" action="">
                                <div class="row">
                                    <div class="kt-login__desc col-lg-12">
                                        <i class="la la-user" style="font-size: 24px; margin-right: 8px;"></i>Cuenta de
                                        administrador
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="text" placeholder="Usuario"
                                               id="kt-login__signup-username" name="username"
                                               autocomplete="off" style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="text" placeholder="Correo electrónico"
                                               id="kt-login__signup-email" name="email"
                                               autocomplete="off" style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="password" placeholder="Contraseña"
                                               name="password" id="kt-login__signup-password"
                                               autocomplete="off" style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="password" placeholder="Confirma contraseña"
                                               name="rpassword" autocomplete="off" id="kt-login__signup-rpassword"
                                               style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="kt-login__desc col-lg-12" style="margin-top: 30px">
                                        <i class="la la-building-o" style="font-size: 24px;margin-right: 8px;"></i>Empresa
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="text" placeholder="Rut comercial"
                                               id="kt-login__signup-rut_organization" name="rut_organization"
                                               autocomplete="off"
                                               style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="input-group col-lg-6">
                                        <input class="form-control" type="text" placeholder="Nombre de tu empresa"
                                               id="kt-login__signup-name_organization" name="name_organization"
                                               autocomplete="off"
                                               style="margin-left: 10px;margin-right: 10px;">
                                    </div>
                                    <div class="row kt-login__extra col-lg-12" style="margin-top: 30px">
                                        <div class="col kt-align-left">
                                            <label class="kt-checkbox">
                                                <input type="checkbox" name="agree">Estoy de acuerdo con los
                                                <a href="#" class="kt-link kt-login__link kt-font-bold">términos y
                                                    condiciones</a>.
                                                <span></span>
                                            </label>
                                            <span class="form-text text-muted"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="kt-login__actions">
                                    <button id="kt_login_signup_submit"
                                            class="btn btn-brand btn-pill kt-login__btn-primary">Registrarse
                                    </button>&nbsp;&nbsp;
                                    <button id="kt_login_signup_cancel"
                                            class="btn btn-secondary btn-pill kt-login__btn-secondary">Cancelar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="kt-login__forgot">
                        <div class="kt-login__head">
                            <h3 class="kt-login__title">¿Olvidaste tu contraseña?</h3>
                            <div class="kt-login__desc">Ingresa tu correo electrónico para restablecer su contraseña:
                            </div>
                        </div>
                        <form class="kt-form" action="">
                            <div class="input-group">
                                <input class="form-control" type="text" placeholder="Correo electrónico" name="email"
                                       id="kt-login__forgot-email"
                                       autocomplete="off">
                            </div>
                            <div class="kt-login__actions">
                                <button id="kt_login_forgot_submit"
                                        class="btn btn-brand btn-pill kt-login__btn-primary">Restablecer
                                </button>&nbsp;&nbsp;
                                <button id="kt_login_forgot_cancel"
                                        class="btn btn-secondary btn-pill kt-login__btn-secondary">Cancelar
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="kt-login__account" style="margin-bottom: 100px;">
								<span class="kt-login__account-msg">
									¿No tienes una cuenta?
								</span>
                        &nbsp;&nbsp;
                        <a href="javascript:;" id="kt_login_signup" class="kt-login__account-link">Regístrate!</a>
                    </div>
                </div>

                <div th:if="${proccess != null and proccess == 'restart_by_email'}" class="kt-login__container">
                    <div class="kt-login__logo">
                        <a href="#">
                            <img alt="" th:src="@{/images/grisk-reverse.png}">
                        </a>
                    </div>
                    <div class="kt-login__postforgot">
                        <div class="kt-login__head">
                            <h3 class="kt-login__title">Restablece tu contraseña</h3>
                            <div class="kt-login__desc">Ingresa la nueva contraseña para la cuenta de <label
                                    th:text="${forgotemail}" style="font-weight: 600;color: #d2d2d2;"></label>:
                            </div>
                        </div>
                        <form class="kt-form" action="">
                            <div class="input-group">
                                <input class="form-control" hidden type="text" placeholder="Email"
                                       th:value="${forgotemail}"
                                       name="postforgotemail" id="kt-login__postforgot-email"
                                       autocomplete="off" style="margin-left: 10px;margin-right: 10px;">
                            </div>
                            <div class="input-group">
                                <input class="form-control" hidden type="text" placeholder="Token"
                                       th:value="${forgottoken}"
                                       name="rpostforgottoken" autocomplete="off" id="kt-login__postforgot-token"
                                       style="margin-left: 10px;margin-right: 10px;">
                            </div>
                            <div class="input-group">
                                <input class="form-control" type="password" placeholder="Nueva contraseña"
                                       name="postforgotpassword" id="kt-login__postforgot-password"
                                       autocomplete="off" style="margin-left: 10px;margin-right: 10px;">
                            </div>
                            <div class="input-group">
                                <input class="form-control" type="password" placeholder="Confirmar contraseña"
                                       name="rpostforgotpassword" autocomplete="off" id="kt-login__postforgot-rpassword"
                                       style="margin-left: 10px;margin-right: 10px;">
                            </div>
                            <div class="kt-login__actions">
                                <button id="kt_login_postforgot_submit"
                                        class="btn btn-brand btn-pill kt-login__btn-primary">Restablecer
                                </button>
                            </div>
                        </form>
                        <div class="kt-form">
                            <div class="kt-login__actions">
                                <a th:href="@{/login}">
                                    <button id="kt_login_postforgot_redirect" hidden
                                            class="btn btn-brand btn-pill kt-login__btn-primary">Ir a login
                                    </button>
                                </a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- end:: Page -->

<!-- begin::Global Config(global config for global JS sciprts) -->
<script>
    var KTAppOptions = {
        "colors": {
            "state": {
                "brand": "#7c0acd",
                "dark": "#282a3c",
                "light": "#ffffff",
                "primary": "#5867dd",
                "success": "#34bfa3",
                "info": "#36a3f7",
                "warning": "#ffb822",
                "danger": "#fd3995"
            },
            "base": {
                "label": ["#c5cbe3", "#a1a8c3", "#3d4465", "#3e4466"],
                "shape": ["#f0f3ff", "#d9dffa", "#afb4d4", "#646c9a"]
            }
        }
    };
</script>

<!-- end::Global Config -->

<!--begin:: Global Mandatory Vendors -->
<script th:src="@{/vendors/general/jquery/dist/jquery.js}" type="text/javascript"></script>
<script th:src="@{/vendors/general/bootstrap/dist/js/bootstrap.min.js}" type="text/javascript"></script>
<script th:src="@{/vendors/general/perfect-scrollbar/dist/perfect-scrollbar.js}" type="text/javascript"></script>
<script th:src="@{/vendors/general/sticky-js/dist/sticky.min.js}" type="text/javascript"></script>


<!--begin::Global Theme Bundle(used by all pages) -->
<script th:src="@{/login/js/scripts.bundle.js}" type="text/javascript"></script>

<!--end::Global Theme Bundle -->

<!--begin::Page Scripts(used by this page) -->
<script th:src="@{/login/js/login-general.js}" type="text/javascript"></script>

<script th:if="${session != null and session['SPRING_SECURITY_LAST_EXCEPTION'] != null and session['SPRING_SECURITY_LAST_EXCEPTION'].message !=null}"
        th:inline="javascript">
    /*<![CDATA[*/
    var messageError = /*[[${session['SPRING_SECURITY_LAST_EXCEPTION'].message}]]*/ 'Ha ocurrido un error inesperado, por favor comuniquese con el administrador del sistema.';
    var login = $('#kt_login');
    var signInForm = login.find('.kt-login__signin form');
    showErrorMsg(signInForm, 'danger', messageError);
    /*]]>*/
</script>
<script th:if="${proccess != null and proccess == 'confirm_by_email_success'}" th:inline="javascript">
    showErrorMsg($('#kt_login').find('.kt-login__signin form'), 'success', 'La confirmación de su cuenta GRisk ha sido realizada con éxito.');
</script>
<script th:if="${errors != null and errors == 'confirm_by_email_token_failed'}" th:inline="javascript">
    showErrorMsg($('#kt_login').find('.kt-login__signin form'), 'info', 'El token ya ha sido utilizado o es invalido, por favor realizar la petición nuevamente.');
</script>
<script th:if="${errors != null and errors == 'restart_by_email_token_failed'}" th:inline="javascript">
    showErrorMsg($('#kt_login').find('.kt-login__signin form'), 'danger', 'El token ya ha sido utilizado o es invalido, por favor realizar la petición de restablecer la contraseña nuevamente.');
</script>
<script th:if="${proccess != null and proccess == 'restart_by_email'}" th:inline="javascript">
    $('#kt_login_postforgot_submit').click(function (e) {
        var login = $('#kt_login');
        e.preventDefault();

        var btn = $(this);
        var form = $(this).closest('form');

        var postforgotrequest = {};
        postforgotrequest["email"] = $("#kt-login__postforgot-email").val();
        postforgotrequest["token"] = $("#kt-login__postforgot-token").val();
        postforgotrequest["pass"] = $("#kt-login__postforgot-password").val();

        form.validate({
            rules: {
                postforgotpassword: {
                    required: true
                },
                rpostforgotpassword: {
                    required: true,
                    equalTo: "#kt-login__postforgot-password"
                }
            }
        });

        if (!form.valid()) {
            return;
        }

        btn.addClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', true);

        $.ajax({
            type: "POST",
            contentType: "application/json",
            url: '/v1/rest/user/post-reset-pass-by-login',
            data: JSON.stringify(postforgotrequest),
            dataType: 'json',
            cache: false,
            timeout: 60000,
            complete: function (data) {
                btn.removeClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', false);
                form.clearForm();
                form.validate().resetForm();
            },
            success: function (data, textStatus, jqXHR) {
                btn.attr('hidden', true);
                $('#kt_login_postforgot_redirect').attr('hidden', false);
                showErrorMsg(form, 'success', 'Genial! Se ha restablecido correctamente su contraseña, por favor ingrese al sistema con sus nuevas credenciales');
            },
            error: function (jqXHR, textStatus, errorThrown) {
                showErrorMsg(form, 'danger', 'Ha ocurrido un problema al realizar el restablecimiento de contraseña, por favor intente nuevamente más tarde.');
            }
        });
    });
</script>
<script th:if="${param.logout}" th:inline="javascript">
    var messageClosedSession = 'Usted ha cerrado sesión.';
    var login = $('#kt_login');
    var signInForm = login.find('.kt-login__signin form');
    signInForm.clearForm();
    signInForm.validate().resetForm();
    showErrorMsg(signInForm, 'info', messageClosedSession);
</script>

<!--end::Page Scripts -->
</body>

<!-- end::Body -->
</html>